<head>
  <title>Lead Caravan - alpha</title>
</head>

<body>
 {{>navigationBar}}

	{{#unless currentUser}}
	<div class="row" >
		<div class="col-md-3">{{> atForm}}</div>	
		<div class="col-md-4">{{> hello}}</div>
		<div class="col-md-5"></div>
	</div>
	{{/unless}}

</body>

<template name="Home">
	{{#if currentUser}}
		{{>baseDash}}
	{{/if}}

</template>


<template name="page1">
	This is page 1
</template>

<template name="page2">
	This is page 2
</template>

<template name="page3">
	This is page 3
</template>

<template name="tabs">
	 <ul class="tabs nav-tabs hide-on-med-and-down">
		<li class="tab col s4"><a id="page-one" href="#" value = "page-1">Page One</a></li>
		<li class="tab col s4"><a id="page-two" href="#">Page Two</a></li>
		<li class="tab col s4"><a id="page-three" href="#">Page Three</a></li>
	</ul>
</template>

<template name="display">
    {{> playerView}}
    <div class="tab-content">
    {{#if activeTab 'nt1'}}
        {{>page1}}
    {{/if}}

    {{#if activeTab 'nt2'}}
        {{>page2}}
    {{/if}}

    {{#if activeTab 'nt3'}}
        {{>page3}}
    {{/if}}
    </div>
</template>


<template name = "userDash">
	{{#if currentUser}}
    
		
		<!-- {{> display}} -->
        {{> playerView}}
        <div class="tab-content">
        {{#if activeTab 'stocks-tab'}}
            <!-- {{>page1}} -->
            <div class="row">
                <div class="col-md-6"> 
                    <!-- {{> yearInfo}} -->
                    {{> stockInfo}} 
                </div>
                <div class="col-md-6">
                    
                </div>
            </div>    
        {{/if}}

        {{#if activeTab 'notif-tab'}}
            {{>alertsTemp}}  
            {{>requestsTemp}}
            <!-- {{>page2}} -->
        {{/if}}

        {{#if activeTab 'messages-tab'}}
            <!-- {{>page3}} -->
            {{> trade}}
        {{/if}}

        </div>
	{{/if}}
</template>

<template name = "adminDash">
	<!-- {{> gameInfo}} -->
	<h4> Kick users!!1! </h4>
	{{> userKicks}}
	<br />

	<button class="skipYear"></button>

	<h4> Edit Stocks </h4>
	{{> stockEditor}}
	<br />
	
	{{#if currentUser}}
		{{>alertsTemp}}  
		{{>requestsTemp}}

		<p>
			{{> stockInfo}}
		</p>
	{{/if}}
</template>

<template name="gameInfo">
	Year: {{gameYear}} <br />
</template>

<template name = "userKicks">
	<form class = "kickPlayer">
		Players in this game:
		<select name = "player" class="form-control">
				<option value="None">  </option> 
			{{#each allUsers}}
				<option value="{{player}}">{{playerName}}</option> 
			{{/each}}
		</select>
		<br />
		<input type = "submit" value ="Kick" class="btn btn-default" />
	</form>
	<br />
	<button class="kickAll btn btn-default">Kick everybody!</button>
	<br />
	<button class="killGame btn btn-default">Delete game</button>
</template>

<template name = "stockEditor">
	<form class = "stockChange">
		Stock:
		<select name = "stock" class="form-control">
			{{#each groupStocks}}
				<option value="{{_id}}">{{gID}}: {{item}} – {{amount}} : {{price}}</option> 
			{{/each}}
		</select><br />
		<input type = "submit" />
	</form>
</template>

<template name = "alertsTemp">

	{{#each allAlerts}}
		<!-- {{contents}} -->
		{{contents.text}}
		<br />
	{{/each}}
	<p>
	<form class="clear-alerts">
		<input type="submit" value = "Mark Alerts as Read" class = "btn btn-default"/>
	</form>
	</p>

</template>

<template name = "requestsTemp">
	{{#each allRequests}}
		{{contents.requester.username}} has asked you for {{contents.reqAmt}} of {{contents.reqRes}}, in exchange for {{contents.recvAmt}} of {{contents.recvRes}}.
		<form class="{{_id}}">
			<input type="submit" value="Accept" id = "accept" />
			<input type="submit" value="Reject" id = "reject" />
		</form>
	{{/each}}
</template>

<template name="userInfo">
	<p>
		Group: {{groupID}}
	</p>
	<p>
		Username: {{userID}}
	</p>
</template>

<template name="yearInfo">
	{{#each annualResource 'polluted'}}
		This is polluted in your market and nobody wants it currently -  {{item}}<br />
	{{/each}}
	{{#each annualResource 'cool'}}
		This is hep/cool (or whatever the kids call it) nowadays! -- {{item}}<br />
	{{/each}}
</template>

<template name = "trade">
	<form class = "trade form-horizontal">
        <div class="form-group">
    		<label class = "control-label col-sm-4">Who do you want to request a trade with?</label>
            <div class = "col-sm-8">
    		<select name = "Recipient" class = "form-control">
    			{{#each otherUsers}}
    				<option value="{{player}}">{{playerName}}</option> 
    			{{/each}}
    		</select>
            </div>
        </div>

		<div class="form-group">
            <label class = "control-label col-sm-4">What do you want to give?</label>
            <div class = "col-sm-8">
            <select name = "GivingResource" class = "form-control">
                {{#each givingResources}}
                    <option value="{{item}}">{{item}}: {{amount}}</option>
                {{/each}}
            </select>
            </div>
        </div>

        <div class="form-group">
            <label class = "control-label col-sm-4">And how much?</label>
            <div class = "col-sm-8">
        		<input type="number" name="giveAmount" class = "form-control"/><br />
            </div>
        </div>

        <div class="form-group">
            <label class = "control-label col-sm-4">What do you want to receive?</label>
            <div class = "col-sm-8">
            <select name = "TakingResource" class = "form-control">
                {{#each allResources}}
                    <option value="{{item}}">{{item}}</option> 
                {{/each}}
            </select>
            </div>
        </div>

        <div class="form-group">
            <label class = "control-label col-sm-4">And how much?</label>
            <div class = "col-sm-8">
                <input type="number" name="requestAmount" class = "form-control"/><br />
            </div>
        </div>

		<input type = "submit" class = "btn btn-default"/>
	</form>
</template>

<template name = "stockInfo">
	<!-- {{prices}} -->
    <div class = "table-responsive">
	<table class="table table-hover table-condensed">
    <thead>
	<tr> 
		<th>Resource</th>
		<th>In Stock</th>
		{{#if stockFeatureShow 'price'}}
			<th>Price</th>
		{{/if}}
		{{#if stockFeatureShow 'group'}}
			<th>Group</th>
		{{/if}}
	</tr>
    </thead>
    <tbody>
		{{#each resources}}
		<tr>
			<td>
                <a class= "viewPriceGraph" value = "{{itemNo}}">
                    {{item}} 
                    {{#if coolCheck yearmod.kind}}
                        - cool right now!
                    {{/if}}
                    {{#if pollutedCheck yearmod.kind}}
                        - polluted right now :(
                    {{/if}}
                </a>
            </td>
			<td>{{amount}}</td>
			{{#if stockFeatureShow 'price'}}
				<td>{{price}}</td>
			{{/if}}
			{{#if stockFeatureShow 'group'}}
				<td>{{groupName}}</td>
			{{/if}}
		</tr>
		{{/each}}
    </tbody>
	</table>
    </div>
	Market value: {{totalValue}}
	<br />
	<!-- {{> priceGraph}} -->
</template>

<template name="priceGraph">
	<div id="stockPriceGraph"></div>
</template>

<template name="hello">
	{{#unless currentUser}}
	<p>Sign up to see things!</p>
	{{/unless}}

</template>


<template name="baseDash">
  <!-- <button class="host">
    Host a new Game
  </button> -->
  <div class="row">	
  <div class="col-md-6">
        <div class="panel panel-default">
          <div class="panel-heading">Play Games</div>
            <ul class="list-group">
                {{#each playingGames}}
                <a href="/games/{{gameCode}}">
                    <li class="list-group-item">
                        {{gameCode}}
                    </li>
                </a>
                {{/each}}
<!--           </ul>
        </div>

    <div class="panel panel-default">
    <ul class="list-group"> -->
    <li class="list-group-item">
      <form class = "gameChoice form form-inline" role = "form">
        <div class="form-group">
            <label for="gameCodeTextBox" class="control-label">Game Code:</label>
            <input type="text" placeholder="1730" name="gameCode" class = "form-control" id = "gameCodeTextBox"/>
            <input type="submit" value = "Join a game" class = "btn btn-default"/>
        </div>
      </form>
    </li>
    </ul>
    </div>

<!--       {{#each adminGames}}
        <a href="/games/{{gameCode}}">{{gameCode}}</a> – {{size}} groups <br />
      {{/each}}
      
      <h3> Play </h3>
      {{#each playingGames}}
        <a href="/games/{{gameCode}}">{{gameCode}}</a>
      {{/each}}
 -->
  </div>

  <div class="col-md-6">
        <div class="panel panel-default">
          <div class="panel-heading">Administrate (or administer, whatever you prefer)</div>
            <ul class="list-group">
                {{#each adminGames}}
                <a href="/games/{{gameCode}}">
                    <li class="list-group-item">
                        {{gameCode}} – {{size}} groups
                    </li>
                </a>
                {{/each}}
          <!-- </ul>
        </div>
    <div class="panel panel-default">
    <ul class="list-group"> -->
    <li class="list-group-item">
	  <form class = "hostGame form form-inline" role = "form">
        <div class="form-group">
    		  <label for="groupSizeTextBox" class="control-label">Groups:</label>
              <input type="number" placeholder="4" name="groups" class = "form-control" id = "groupSizeTextBox"/>
    		<input type="submit" value = "Host new game" class = "btn btn-default" /> 
    		<sub>(Please enter less than 8 if you don't want all the things to break)</sub>
        </div>
	  </form>
    </li>
    </ul>
    </div>
	  
  </div>
  

  </div>
</template>
